Description: fix denial of service via IXFR or DDNS update
Origin: upstream, extracted from 9.7.3 tarball

Index: bind9-9.7.1.dfsg.P2/lib/dns/rbtdb.c
===================================================================
--- bind9-9.7.1.dfsg.P2.orig/lib/dns/rbtdb.c	2011-02-23 08:30:13.000000000 -0500
+++ bind9-9.7.1.dfsg.P2/lib/dns/rbtdb.c	2011-02-23 08:30:24.000000000 -0500
@@ -2116,7 +2116,7 @@
 	unsigned int locknum;
 	unsigned int refs;
 
-	RBTDB_LOCK(&rbtdb->lock, isc_rwlocktype_write);
+	RWLOCK(&rbtdb->tree_lock, isc_rwlocktype_write);
 	for (locknum = 0; locknum < rbtdb->node_lock_count; locknum++) {
 		NODE_LOCK(&rbtdb->node_locks[locknum].lock,
 			  isc_rwlocktype_write);
@@ -2126,7 +2126,7 @@
 		NODE_UNLOCK(&rbtdb->node_locks[locknum].lock,
 			    isc_rwlocktype_write);
 	}
-	RBTDB_UNLOCK(&rbtdb->lock, isc_rwlocktype_write);
+	RWUNLOCK(&rbtdb->tree_lock, isc_rwlocktype_write);
 	if (again)
 		isc_task_send(task, &event);
 	else {
